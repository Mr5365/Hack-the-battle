<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>2048</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #faf8ef;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    height: 100vh;
    margin: 0;
  }
  h1 {
    font-size: 48px;
    margin: 20px;
    color: #776e65;
  }
  #rules-screen {
    margin-top: 50px;
    background: #eee4da;
    padding: 20px;
    border-radius: 10px;
    text-align: center;
    max-width: 400px;
  }
  #rules-screen h2 {
    margin-bottom: 15px;
    color: #776e65;
  }
  #rules-screen p {
    font-size: 16px;
    color: #776e65;
    margin: 10px 0;
  }
  #rules-screen button {
    margin-top: 20px;
    padding: 10px 20px;
    font-size: 18px;
    border: none;
    border-radius: 6px;
    background: #8f7a66;
    color: white;
    cursor: pointer;
  }
  #rules-screen button:hover { background: #776e65; }

  #controls {
    margin-bottom: 15px;
    display: none;
  }
  button {
    padding: 10px 20px;
    margin: 5px;
    font-size: 16px;
    border: none;
    border-radius: 6px;
    background: #8f7a66;
    color: white;
    cursor: pointer;
  }
  button:hover { background: #776e65; }

  #game-container {
    background: #bbada0;
    padding: 15px;
    border-radius: 10px;
    position: relative;
    display: none;
  }
  .row { display: flex; }
  .cell {
    width: 80px; height: 80px; margin: 5px;
    background: #cdc1b4; font-size: 24px; font-weight: bold;
    display: flex; justify-content: center; align-items: center;
    border-radius: 5px; color: #776e65;
  }
  #pause-overlay {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(238, 228, 218, 0.85);
    display: none;
    justify-content: center;
    align-items: center;
    font-size: 32px;
    font-weight: bold;
    color: #776e65;
    border-radius: 10px;
    z-index: 10;
  }
</style>
</head>
<body>
  <h1>2048</h1>

  <!-- Rules Screen -->
  <div id="rules-screen">
    <h2>How to Play</h2>
    <p>Use the arrow keys (↑, ↓, ←, →) to move tiles.</p>
    <p>When two tiles with the same number touch, they merge into one.</p>
    <p>Your goal is to create the 2048 tile!</p>
    <button onclick="startGame()">Start Game</button>
  </div>

  <!-- Game Controls -->
  <div id="controls">
    <button onclick="goHome()">Back to Home</button>
    <button onclick="pauseGame()">Pause</button>
    <button onclick="resumeGame()">Resume</button>
    <button onclick="initGrid()">New Game</button>
  </div>

  <!-- Game Board -->
  <div id="game-container">
    <div id="pause-overlay">Paused</div>
  </div>

<script>
const size = 4;
let grid = [];
let container = document.getElementById('game-container');
let paused = false;

function initGrid() {
  grid = [];
  container.innerHTML = '<div id="pause-overlay">Paused</div>';
  for(let i=0;i<size;i++){
    let row = [];
    let rowDiv = document.createElement('div'); rowDiv.className='row';
    for(let j=0;j<size;j++){
      row.push(0);
      let cellDiv = document.createElement('div'); cellDiv.className='cell';
      rowDiv.appendChild(cellDiv);
    }
    grid.push(row);
    container.appendChild(rowDiv);
  }
  addRandom();
  addRandom();
  updateGrid();
}

function addRandom(){
  let empty = [];
  for(let i=0;i<size;i++){
    for(let j=0;j<size;j++){
      if(grid[i][j]===0) empty.push({i,j});
    }
  }
  if(empty.length===0) return;
  let {i,j} = empty[Math.floor(Math.random()*empty.length)];
  grid[i][j] = Math.random()<0.9?2:4;
}

function updateGrid(){
  for(let i=0;i<size;i++){
    for(let j=0;j<size;j++){
      container.children[i+1].children[j].innerText = grid[i][j]===0?'':grid[i][j];
      container.children[i+1].children[j].style.background = getColor(grid[i][j]);
    }
  }
}

function getColor(val){
  switch(val){
    case 0: return '#cdc1b4';
    case 2: return '#eee4da';
    case 4: return '#ede0c8';
    case 8: return '#f2b179';
    case 16: return '#f59563';
    case 32: return '#f67c5f';
    case 64: return '#f65e3b';
    case 128: return '#edcf72';
    case 256: return '#edcc61';
    case 512: return '#edc850';
    case 1024: return '#edc53f';
    case 2048: return '#edc22e';
    default: return '#3c3a32';
  }
}

function slide(row){
  let arr = row.filter(v=>v!==0);
  for(let i=0;i<arr.length-1;i++){
    if(arr[i]===arr[i+1]){ arr[i]*=2; arr[i+1]=0; }
  }
  arr = arr.filter(v=>v!==0);
  while(arr.length<size) arr.push(0);
  return arr;
}

function move(dir){
  if(paused) return;
  let moved = false;
  if(dir==='left'){
    for(let i=0;i<size;i++){
      let old = [...grid[i]];
      grid[i] = slide(grid[i]);
      if(old.join(',')!==grid[i].join(',')) moved=true;
    }
  } else if(dir==='right'){
    for(let i=0;i<size;i++){
      let old = [...grid[i]];
      grid[i] = slide(grid[i].reverse()).reverse();
      if(old.join(',')!==grid[i].join(',')) moved=true;
    }
  } else if(dir==='up'){
    for(let j=0;j<size;j++){
      let col = [];
      for(let i=0;i<size;i++) col.push(grid[i][j]);
      let old = [...col];
      col = slide(col);
      for(let i=0;i<size;i++) grid[i][j]=col[i];
      if(old.join(',')!==col.join(',')) moved=true;
    }
  } else if(dir==='down'){
    for(let j=0;j<size;j++){
      let col = [];
      for(let i=0;i<size;i++) col.push(grid[i][j]);
      let old = [...col];
      col = slide(col.reverse()).reverse();
      for(let i=0;i<size;i++) grid[i][j]=col[i];
      if(old.join(',')!==col.join(',')) moved=true;
    }
  }
  if(moved){ addRandom(); updateGrid(); checkGameOver(); }
}

function checkGameOver(){
  for(let i=0;i<size;i++){
    for(let j=0;j<size;j++){
      if(grid[i][j]===0) return;
      if(j<size-1 && grid[i][j]===grid[i][j+1]) return;
      if(i<size-1 && grid[i][j]===grid[i+1][j]) return;
    }
  }
  alert('Game Over!');
}

// Controls
document.addEventListener('keydown',(e)=>{
  if(e.key==='ArrowLeft') move('left');
  else if(e.key==='ArrowRight') move('right');
  else if(e.key==='ArrowUp') move('up');
  else if(e.key==='ArrowDown') move('down');
});

// Home, Pause, Resume
function goHome(){
  window.location.href = "index.html"; // change as needed
}
function pauseGame(){
  paused = true;
  document.getElementById('pause-overlay').style.display='flex';
}
function resumeGame(){
  paused = false;
  document.getElementById('pause-overlay').style.display='none';
}

// Show rules first
function startGame(){
  document.getElementById('rules-screen').style.display = 'none';
  document.getElementById('controls').style.display = 'block';
  document.getElementById('game-container').style.display = 'block';
  initGrid();
}
</script>
</body>
</html>